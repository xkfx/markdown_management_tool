<div id="diy_right_menu">
<h2>ç´¢å¼•</h2>
<ul>
<li><a href="#anchor0">ä¸€ã€æ ¡éªŒæ•ˆæœæ¼”ç¤º</a></li>
<li><a href="#anchor1">äºŒã€æ ¡éªŒå™¨å®šä¹‰ç¤ºä¾‹</a>
<ul>
<li><a href="#anchor2">å®šä¹‰ä¸€ä¸ªæœ€ç®€å•çš„æ ¡éªŒå™¨</a></li>
<li><a href="#anchor3">æ­£åˆ™æ ¡éªŒå™¨</a></li>
</ul>
</li>
<li><a href="#anchor4">ä¸‰ã€EasyValidatorçš„å®ç°</a></li>
<li><a href="#anchor5">å››ã€æ›´å¥½çš„åº”ç”¨å§¿åŠ¿&mdash;&mdash;é…åˆæ³¨è§£å’Œé¢å‘åˆ‡é¢</a></li>
</ul>
</div>
<p>&ldquo;å‚æ•°æ ¡éªŒ&rdquo;å±äºæ¯”è¾ƒæ— èŠä½†æ˜¯åˆéå¸¸ç¡¬æ€§çš„éœ€æ±‚ã€‚ã€‚ã€‚</p>
<p>æœ€åŸå§‹çš„æ–¹å¼å°±æ˜¯åœ¨æ–¹æ³•å¤´æ‰‹åŠ¨é€ä¸ªæ ¡éªŒï¼Œä½†æ˜¯è¿™æ ·å†™ä¸å¤ªå¥½çœ‹ï¼Œè€Œä¸”å®¹æ˜“é€ æˆå¤§é‡é‡å¤ä»£ç ï¼Œæ‰©å±•èµ·æ¥ä¹Ÿä¸æ˜¯å¾ˆæ–¹ä¾¿ã€‚</p>
<p>æˆ‘ç®€å•çœ‹äº†ä¸€ä¸‹å·²æœ‰çš„Spring&nbsp;Validationï¼Œç²—çœ‹ä¸‹å»ä¸å¤ªåˆèƒƒå£ï¼ˆPS. å…¶å®æ˜¯çœ‹ä¸æ‡‚ğŸ˜…ï¼‰ã€‚æƒ³æƒ³å†™ä¸€ä¸ªä¼¼ä¹ä¹Ÿä¸éš¾ï¼Œäºæ˜¯å°è¯•è‡ªå®šä¹‰äº†ä¸€ä¸ªç®€å•çš„ç©å…·ç‰ˆæœ¬ã€‚</p>
<h2><a name="anchor0"></a>ä¸€ã€æ ¡éªŒæ•ˆæœæ¼”ç¤º</h2>
<p>MyTest.javaï¼š</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> MyTest {
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * åˆ›å»ºä¸€æ¬¡ï¼Œåº”ç”¨Næ¬¡ã€‚
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> EasyValidator EASY_VALIDATOR = <span style="color: #0000ff;">new</span><span style="color: #000000;"> EasyValidator();

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> å…è®¸è‡ªå®šä¹‰å„ç§å„æ ·çš„æ ¡éªŒå™¨ï¼Œåªéœ€å®ç°Validatoræ¥å£å³å¯</span>
        EASY_VALIDATOR.addValidator(<span style="color: #0000ff;">new</span><span style="color: #000000;"> RegexpValidator());
        EASY_VALIDATOR.addValidator(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> TypeValidator());

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> ç¤ºä¾‹&darr;</span>
        <span style="color: #0000ff;">int</span> type = 3<span style="color: #000000;">;
        String username </span>= "           "<span style="color: #000000;">;
        String password </span>= "32"<span style="color: #000000;">;
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> é€šè¿‡æŠ›å¼‚å¸¸çš„æ–¹å¼ä¼ é€’å…·ä½“é”™è¯¯ä¿¡æ¯</span>
        EASY_VALIDATOR.check(type, "type"<span style="color: #000000;">);
        EASY_VALIDATOR.check(username, </span>"username.regexp"<span style="color: #000000;">);
        EASY_VALIDATOR.check(password, </span>"password.regexp"<span style="color: #000000;">);
    }
}
</span><span style="color: #008000;">/*</span><span style="color: #008000;">
ouput example - 1:
Exception in thread "main" org.sample.exception.<strong>ValidateException: typeè¶Šç•Œäº†ï¼</strong>
ouput example - 2:
Exception in thread "main" org.sample.exception.<strong>ValidateException: ç”¨æˆ·åä¸èƒ½ä¸ºç©º
 </strong></span><span style="color: #008000;">*/</span></pre>
</div>
<p>é€šè¿‡<strong>addValidatoræ–¹æ³•</strong>è®©æ ¡éªŒå™¨ç”Ÿæ•ˆã€‚</p>
<h2><a name="anchor1"></a>äºŒã€æ ¡éªŒå™¨å®šä¹‰ç¤ºä¾‹</h2>
<p>ä»…éœ€å®ç°<strong>Validatoræ¥å£</strong>å°±å¯ä»¥éšå¿ƒæ‰€æ¬²åœ°å®šä¹‰å„å¼å„æ ·çš„å‚æ•°æ ¡éªŒå™¨ã€‚</p>
<p>Validatoræ¥å£ä»…åŒ…å«ä¸‰ä¸ªéå¸¸ç®€å•çš„æ–¹æ³•ï¼š</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('b7fa50fa-42f4-45fc-bca3-2c90935d06bb')"><img src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" id="code_img_closed_b7fa50fa-42f4-45fc-bca3-2c90935d06bb" class="code_img_closed" /><img src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" id="code_img_opened_b7fa50fa-42f4-45fc-bca3-2c90935d06bb" class="code_img_opened" style="display: none;" />
<div id="cnblogs_code_open_b7fa50fa-42f4-45fc-bca3-2c90935d06bb" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">interface</span><span style="color: #000000;"> Validator {

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * ç”¨äºæ ‡è¯†å’ŒæŸ¥æ‰¾æ ¡éªŒå™¨
     </span><span style="color: #008000;">*/</span><span style="color: #000000;">
    String getName();

    </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> validate(Object o);

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * ä¾¿äºå¤šçº§æŸ¥æ‰¾æ ¡éªŒæ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒè¯¥åŠŸèƒ½ï¼Œ
     * ç›´æ¥å†…éƒ¨è°ƒvoid validate(Object o);æ–¹æ³•å³å¯
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">void</span><span style="color: #000000;"> validate(Object o, String validatorName);
}</span></pre>
</div>
<span class="cnblogs_code_collapse">Validator.java</span></div>
<h3><a name="anchor2"></a>å®šä¹‰ä¸€ä¸ªæœ€ç®€å•çš„æ ¡éªŒå™¨</h3>
<p><strong>validateæ–¹æ³•</strong>è¯´æ˜ï¼šæ ¡éªŒä¸é€šè¿‡æŠ›å¼‚å¸¸å°±okäº†ï¼Œåœ¨å¼‚å¸¸é‡Œä¼ é€’å…·ä½“é”™è¯¯ä¿¡æ¯ã€‚</p>
<p>å®šä¹‰ä¸æŠ›å¼‚å¸¸çš„æ ¡éªŒå™¨ã€‚ã€‚æ˜¯æ²¡æ„ä¹‰çš„ã€‚åœ¨&ldquo;ä¼ Result&rdquo;å’Œ&ldquo;ä¼ å¼‚å¸¸&rdquo;é—´æˆ‘ä¹Ÿæƒè¡¡äº†ä¸€ä¸‹ï¼Œç½‘ä¸Šè¯´&ldquo;ä¼ å¼‚å¸¸&rdquo;æ²¡&ldquo;ä¼ Result&rdquo;æ€§èƒ½å¥½ï¼Œä½†å°±å†™ä»£ç çš„è§’åº¦æ¥çœ‹ï¼Œè¿˜æ˜¯ä¼ å¼‚å¸¸å¹²å‡€å¾—å¤šï¼Œå¹¶ä¸”æ›´ç®€å•</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> TypeValidator <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Validator {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String NAME = "type"<span style="color: #000000;">;

    @Override
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String getName() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> NAME;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> validate(Object o) {
        </span><span style="color: #0000ff;">int</span> i =<span style="color: #000000;"> Integer.parseInt(String.valueOf(o));
        </span><strong><span style="color: #008000;">//</span><span style="color: #008000;"> é€šè¿‡æŠ›å¼‚å¸¸çš„æ–¹å¼ä¼ é€’å…·ä½“é”™è¯¯ä¿¡æ¯</span></strong>
        <span style="color: #0000ff;">if</span> (i &lt; 0 || i &gt; 10) <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ValidateException("typeè¶Šç•Œäº†ï¼"<span style="color: #000000;">);
        </span><strong><span style="color: #008000;">//</span><span style="color: #008000;"> æ²¡æŠ›å‡ºå¼‚å¸¸ä»£è¡¨æ²¡é—®é¢˜ï¼</span></strong>
<span style="color: #000000;">    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> validate(Object o, String validatorName) {
        validate(o);
    }
}</span></pre>
</div>
<h3><a name="anchor3"></a>æ­£åˆ™æ ¡éªŒå™¨</h3>
<p>åŒæ ·å¯ä»¥å®šä¹‰ä¸€ä¸ªå¤æ‚äº›çš„æ ¡éªŒå™¨&darr;</p>
<p>åŸå§‹ç‰ˆæœ¬æ¥è‡ª<a id="homepage1_HomePageDays_DaysList_ctl01_DayList_TitleUrl_0" class="postTitle2" href="https://www.cnblogs.com/xkxf/p/10340965.html">Springç¬”è®°#02#åˆ©ç”¨åˆ‡é¢å’Œæ³¨è§£æ ¡éªŒæ–¹æ³•å‚æ•°</a></p>
<p>è¿™æ˜¯ä¸€ä¸ªä¸“é—¨ç”¨æ¥æ ¡éªŒå­—ç¬¦ä¸²çš„æ ¡éªŒå™¨ï¼Œæ€è·¯å°±æ˜¯ç”¨.propertiesæ–‡ä»¶å­˜é”®å€¼å¯¹ï¼ˆ&ldquo;å&rdquo;-æ­£åˆ™ï¼‰ç„¶åè¯»åˆ°HashMapæ„é€ Patternã€‚æ ¹æ®&ldquo;å&rdquo;æŸ¥æ‰¾å¯¹åº”çš„Patternè¿›è¡Œæ­£åˆ™æ ¡éªŒã€‚é¡ºä¾¿æä¸€ä¸‹<strong>è‡ªå®šä¹‰çš„ä¸¤ç§å¼‚å¸¸ï¼šValidatorExceptionå’ŒValidateException</strong>ï¼Œä¸¤ä¸ªå¼‚å¸¸éƒ½ç»§æ‰¿è‡ªè¿è¡Œæ—¶å¼‚å¸¸ï¼Œè¿™æ ·ä¸è‡³äºæŠŠä»£ç æä¹±ï¼Œå‰è€…å±äºç¨‹åºå‘˜çš„é”™è¯¯ï¼Œåè€…åˆ™ç”¨äºæŠ›å‡ºæ ¡éªŒå¤±è´¥çš„å…·ä½“ä¿¡æ¯ã€‚</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> RegexpValidator <span style="color: #0000ff;">implements</span><span style="color: #000000;"> Validator {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String NAME = "regexp"<span style="color: #000000;">;

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String FILE_NAME = File.separator + "easy-validator.properties"<span style="color: #000000;">;

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> Map&lt;String, Pattern&gt; MAP = <span style="color: #0000ff;">new</span> HashMap&lt;&gt;<span style="color: #000000;">();

    </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> æŠŠ.propertiesæ–‡ä»¶é‡Œçš„é”®å€¼å¯¹è¯»åˆ°å†…å­˜é‡Œ</span>
        Properties prop = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Properties();
        </span><span style="color: #0000ff;">try</span> (InputStream input = ServiceMethodAspect.<span style="color: #0000ff;">class</span><span style="color: #000000;">.getClassLoader().getResourceAsStream(FILE_NAME)){
            </span><span style="color: #0000ff;">if</span> (input == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> RuntimeException("unable to find " +<span style="color: #000000;"> FILE_NAME);
            }
            prop.load(input);
            Enumeration</span>&lt;?&gt; e =<span style="color: #000000;"> prop.propertyNames();
            </span><span style="color: #0000ff;">while</span><span style="color: #000000;"> (e.hasMoreElements()) {
                String key </span>=<span style="color: #000000;"> (String) e.nextElement();
                String value </span>=<span style="color: #000000;"> prop.getProperty(key);
                MAP.put(key, Pattern.compile(value));
            }
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException e) {
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> RuntimeException("An exception occurred while reading " +<span style="color: #000000;"> FILE_NAME, e);
        }
    }

    @Override
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String getName() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> NAME;
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> validate(Object o) {
        </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ValidatorException("validate(Object o)æ–¹æ³•æœªå®šä¹‰"<span style="color: #000000;">);
    }

    @Override
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> validate(Object o, String validatorName) {
        String str </span>=<span style="color: #000000;"> String.valueOf(o);
        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (StringUtils.isBlank(str)) {
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ValidateException(PresentationUtils.english2chinese(validatorName) + "ä¸èƒ½ä¸ºç©º"<span style="color: #000000;">);
        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
            Pattern pattern </span>=<span style="color: #000000;"> MAP.get(validatorName);
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> ç¨‹åºå‘˜è¦ç¡®ä¿æ ¼å¼å·²ç»å®šä¹‰</span>
            <span style="color: #0000ff;">if</span> (pattern == <span style="color: #0000ff;">null</span>) <span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ValidatorException(validatorName + "æ ¡éªŒå™¨æœªå®šä¹‰"<span style="color: #000000;">);
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> æ ¼å¼æ£€æŸ¥</span>
            <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">pattern.matcher(str).matches()) {
                </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ValidateException(PresentationUtils.english2chinese(validatorName) + "æ ¼å¼ä¸æ­£ç¡®"<span style="color: #000000;">);
            }
        }
    }
}</span></pre>
</div>
<p>åœ¨ç›¸åº”è·¯å¾„ä¸‹çš„<strong>easy-validator.properties</strong>ä¸­å®šä¹‰æ­£åˆ™è¡¨è¾¾å¼ï¼š</p>
<div class="cnblogs_code">
<pre>username=^<span style="color: #800000; font-weight: bold;">[</span><span style="color: #800000;">a-zA-Z0-9_</span><span style="color: #800000; font-weight: bold;">]</span>{4,16<span style="color: #000000;">}$
<span style="color: #888888;"># ç”¨æˆ·åï¼š4åˆ°16ä½å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿</span>
password</span>=^<span style="color: #800000; font-weight: bold;">[</span><span style="color: #800000;">a-zA-Z0-9_</span><span style="color: #800000; font-weight: bold;">]</span>{6,16<span style="color: #000000;">}$
<span style="color: #888888;"># å¯†ç ï¼š6åˆ°16ä½å¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿</span></span></pre>
</div>
<h2><a name="anchor4"></a>ä¸‰ã€EasyValidatorçš„å®ç°</h2>
<p><span style="text-decoration: line-through;">EasyValidatorçš„å®ç°åƒå®ƒçš„åå­—ä¸€æ ·ç®€å•ã€‚æ¯ä¸ªæ ¡éªŒå™¨ç”±getName()çš„è¿”å›å€¼æ ‡è¯†ï¼ˆç¡®ä¿å”¯ä¸€ï¼‰ï¼Œå…è®¸è‡ªå®šä¹‰å¤šçº§æ ¡éªŒå™¨ï¼Œå‘½åè§„åˆ™ä¸º&ldquo;xx.æ¬¡çº§æ ¡éªŒå™¨å.é¡¶çº§æ ¡éªŒå™¨å&rdquo;ï¼Œè¯¦ç»†åŒ¹é…è¿‡ç¨‹å‚è€ƒä»£ç å®ç°ï¼š</span></p>
<p>æœ‰é€»è¾‘é”™è¯¯ï¼Œå®é™…åªèƒ½å®šä¹‰ä¸¤çº§ã€‚å¤šçº§é è‡ªå®šä¹‰&radic;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">/**</span><span style="color: #008000;">
 * è‡ªå®šä¹‰çš„ä¸€ä¸ªç®€æ˜“å‚æ•°æ ¡éªŒå™¨
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> EasyValidator {
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * åˆå§‹åŒ–åä¸å†æ›´æ–°ï¼Œå¦åˆ™åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹æœ‰é£é™©
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> Map&lt;String, Validator&gt; MAP = <span style="color: #0000ff;">new</span> HashMap&lt;&gt;<span style="color: #000000;">();

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> addValidator(Validator validator) {
        MAP.put(validator.getName(), validator);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> check(Object object, String validatorName) {
        Validator validator </span>=<span style="color: #000000;"> MAP.get(getLast(validatorName));
        </span><span style="color: #0000ff;">if</span> (validator != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            validator.validate(object, removeLast(validatorName));
        } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> ValidatorException("validator not found, validatorName=" +<span style="color: #000000;"> validatorName);
        }
    }

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * è·å–é¡¶çº§æ ¡éªŒå™¨åç§°ï¼Œå¦‚æœåªæœ‰ä¸€çº§å°±åŸæ ·è¿”å›
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> String getLast(String validatorName) {
        </span><span style="color: #0000ff;">int</span> index = StringUtils.lastIndexOf(validatorName, '.'<span style="color: #000000;">);
        </span><span style="color: #0000ff;">if</span> (index == -1) <span style="color: #0000ff;">return</span><span style="color: #000000;"> validatorName;
        </span><span style="color: #0000ff;">return</span> StringUtils.substring(validatorName, index + 1<span style="color: #000000;">);
    }

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * å»æ‰é¡¶çº§æ ¡éªŒå™¨åç§°ï¼Œä»¥ä¾¿å‘ä¸‹ä¼ é€’ï¼Œå¦‚æœåªæœ‰ä¸€çº§å°±åŸæ ·è¿”å›
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> String removeLast(String validatorName) {
        </span><span style="color: #0000ff;">int</span> index = StringUtils.lastIndexOf(validatorName, '.'<span style="color: #000000;">);
        </span><span style="color: #0000ff;">if</span> (index == -1) <span style="color: #0000ff;">return</span><span style="color: #000000;"> validatorName;
        </span><span style="color: #0000ff;">return</span> StringUtils.substring(validatorName, 0<span style="color: #000000;">, index);
    }
}</span></pre>
</div>
<h2><a name="anchor5"></a>å››ã€æ›´å¥½çš„åº”ç”¨å§¿åŠ¿&mdash;&mdash;é…åˆæ³¨è§£å’Œé¢å‘åˆ‡é¢</h2>
<p>Exampleä»£ç ï¼ˆå› ä¸ºç”¨åˆ°äº†Springçš„é»‘ç§‘æŠ€ï¼Œéœ€è¦æ·»åŠ ç›¸åº”ä¾èµ–ï¼‰ï¼š</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">@Aspect
@Configuration
</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> ServiceMethodAspect {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> Logger LOGGER =<span style="color: #000000;"> LogManager.getLogger();

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> ParameterNameDiscoverer DISCOVERER = <span style="color: #0000ff;">new</span><span style="color: #000000;"> LocalVariableTableParameterNameDiscoverer();

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> EasyValidator EASY_VALIDATOR = <span style="color: #0000ff;">new</span><span style="color: #000000;"> EasyValidator();

    </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> {
        EASY_VALIDATOR.addValidator(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> RegexpValidator());
    }

    @Pointcut(</span>"execution(* org.sample.shop.common.service.impl.*.*(..))"<span style="color: #000000;">)
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> serviceMethod() {}

    @Around(</span>"serviceMethod()"<span style="color: #000000;">)
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> ServiceResult work(ProceedingJoinPoint jp) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> å‚æ•°æ ¡éªŒ</span>
        Method method =<span style="color: #000000;"> ((MethodSignature) jp.getSignature()).getMethod();
        Parameter[] parameter </span>= method.getParameters(); <span style="color: #008000;">//</span><span style="color: #008000;"> ä¾¿äºè·å–æ³¨è§£å¯¹è±¡</span>
        String[] parameterName =<span style="color: #000000;"> DISCOVERER.getParameterNames(method);
        Object[] parameterValue </span>= jp.getArgs(); 
<span style="color: #000000;">        String currentValidatorName;
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> é€ä¸ªå‚æ•°è¿›è¡Œæ ¡éªŒï¼Œå…ˆå°è¯•è·å–Validatoræ³¨è§£å€¼ï¼Œæ³¨è§£ä¸å­˜åœ¨ç”¨å‚æ•°åä½œä¸ºæ ¡éªŒå™¨å</span>
            <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 0; i != parameter.length; ++<span style="color: #000000;">i) {
                </span><span style="color: #0000ff;">if</span> (parameter[i].getAnnotation(Validator.<span style="color: #0000ff;">class</span>) != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                    currentValidatorName </span>= parameter[i].getAnnotation(Validator.<span style="color: #0000ff;">class</span><span style="color: #000000;">).value();
                } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                    currentValidatorName </span>=<span style="color: #000000;"> parameterName[i];
                }
                LOGGER.info(</span>"check: object={}, validatorName={}", parameterValue[i], currentValidatorName); <span style="color: #008000;">//</span><span style="color: #008000;"> å¶å°”å‡ºç°æ ¡éªŒå¼‚å¸¸æœ‰æ—¥å¿—å¯æŸ¥ TODO ç”¨æˆ·ä¿¡æ¯</span>
<span style="color: #000000;"><strong>                EASY_VALIDATOR.check(parameterValue[i], currentValidatorName);</strong>
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> (ServiceResult) jp.proceed();
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (ValidateException e) {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ServiceResult.fail(e.getMessage());
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Throwable throwable) {
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> é”™è¯¯æ—¥å¿—</span>
            LOGGER.error(<span style="color: #0000ff;">new</span><span style="color: #000000;"> DetailedInfo(jp.getArgs(), throwable.getMessage()), throwable);
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ServiceResult.error();
        }
    }

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> DetailedInfo {

        </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> Object[] args;

        </span><span style="color: #0000ff;">private</span><span style="color: #000000;"> String message;

        DetailedInfo(Object[] args, String message) {
            </span><span style="color: #0000ff;">this</span>.args =<span style="color: #000000;"> args;
            </span><span style="color: #0000ff;">this</span>.message =<span style="color: #000000;"> message;
        }

        @Override
        </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String toString() {
            </span><span style="color: #0000ff;">return</span> "DetailedInfo{" +
                    "args=" + Arrays.toString(args) +
                    ", message='" + message + '\'' +
                    '}'<span style="color: #000000;">;
        }
    }
}</span></pre>
</div>
<p>é€šè¿‡æ³¨è§£æŒ‡å®šæ ¡éªŒå™¨ï¼š</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">    @Override
    </span><span style="color: #0000ff;">public</span> ServiceResult&lt;User&gt; getUser(<strong>@Validator("username.regexp")</strong> String username, <strong>@Validator("password.regexp"</strong><span style="color: #000000;"><strong>)</strong> String password) {
        </span><span style="color: #0000ff;">return</span> ServiceUtils.daoOperation(() -&gt;<span style="color: #000000;"> {
            User user </span>=<span style="color: #000000;"> userDAO.getUser(username, password);
            </span><span style="color: #0000ff;">return</span> user != <span style="color: #0000ff;">null</span> ? ServiceResult.ok(user) : <span style="color: #0000ff;">new</span> ServiceResult&lt;&gt;<span style="color: #000000;">(LOGIN_FAIL);
        }, Connection.TRANSACTION_READ_COMMITTED);
    }</span></pre>
</div>
<p>æ³¨è§£çš„å®ç°ä¾ç„¶å’Œ<a id="homepage1_HomePageDays_DaysList_ctl01_DayList_TitleUrl_0" class="postTitle2" href="https://www.cnblogs.com/xkxf/p/10340965.html">Springç¬”è®°#02#åˆ©ç”¨åˆ‡é¢å’Œæ³¨è§£æ ¡éªŒæ–¹æ³•å‚æ•°</a>é‡Œçš„å·®ä¸å¤šï¼Œåªä¸è¿‡æ¢äº†ä¸ªåå­—ã€‚ã€‚ã€‚</p>