<p>参考资料：<a href="http://www.ntu.edu.sg/home/ehchua/programming/java/javanativeinterface.html" target="_blank">http://www.ntu.edu.sg/home/ehchua/programming/java/javanativeinterface.html</a>（很详细）</p>
<p>看jdk源代码时，经常会看到类似下面的代码：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">native</span> <span style="color: #0000ff;">int</span> read0() <span style="color: #0000ff;">throws</span> IOException;&nbsp;</pre>
</div>
<p>该类接口需要由c/c++实现。言下之意，它的实现与特定操作系统密切相关。</p>
<p>&nbsp;</p>
<p>1、尝试自己实现一个简单的native接口：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> TestNativeMethod {

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">native</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> sayHello();
    
    </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> {
        System.loadLibrary(</span>"sayHello_impl"<span style="color: #000000;">);
    } 

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        sayHello();
    }
}</span></pre>
</div>
<p>直接编译是ok的，不过没法正常运行：</p>
<div class="cnblogs_code">
<pre>mdzz@LAPTOP-QGECNCGO MINGW64 /d/<span style="color: #000000;">lab2
$<strong> javac</strong> TestNativeMethod.java

mdzz@LAPTOP</span>-QGECNCGO MINGW64 /d/<span style="color: #000000;">lab2
$<strong> java</strong> TestNativeMethod
java.lang.UnsatisfiedLinkError: no <strong>sayHello_impl</strong> in java.library.path
        at java.lang.ClassLoader.loadLibrary(Unknown Source)
        at java.lang.Runtime.loadLibrary0(Unknown Source)
        at java.lang.System.loadLibrary(Unknown Source)
        at TestNativeMethod.</span>&lt;clinit&gt;(TestNativeMethod.java:6<span style="color: #000000;">)
Exception in thread </span>"main"</pre>
</div>
<p>2、通过<strong>javah -jni TestNativeMethod</strong>命令得到<strong>TestNativeMethod.h（c/c++版本的&ldquo;接口&rdquo;）：</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">/*</span><span style="color: #008000;"> DO NOT EDIT THIS FILE - it is machine generated </span><span style="color: #008000;">*/</span><span style="color: #000000;">
#include </span>&lt;jni.h&gt;
<span style="color: #008000;">/*</span><span style="color: #008000;"> Header for class TestNativeMethod </span><span style="color: #008000;">*/</span><span style="color: #000000;">

#ifndef _Included_TestNativeMethod
</span><span style="color: #0000ff;">#define</span> _Included_TestNativeMethod<span style="color: #000000;">
#ifdef __cplusplus
</span><span style="color: #0000ff;">extern</span> <span style="color: #800000;">"</span><span style="color: #800000;">C</span><span style="color: #800000;">"</span><span style="color: #000000;"> {
</span><span style="color: #0000ff;">#endif</span>
<span style="color: #008000;">/*</span><span style="color: #008000;">
 * Class:     TestNativeMethod
 * Method:    sayHello
 * Signature: ()V
 </span><span style="color: #008000;">*/</span><span style="color: #000000;">
JNIEXPORT </span><span style="color: #0000ff;">void</span><span style="color: #000000;"> JNICALL Java_TestNativeMethod_sayHello
  (JNIEnv </span>*<span style="color: #000000;">, jclass);

#ifdef __cplusplus
}
</span><span style="color: #0000ff;">#endif</span>
<span style="color: #0000ff;">#endif</span></pre>
</div>
<p>3、书写相应的C/C++实现<strong>sayHello_impl.cpp</strong>：</p>
<div class="cnblogs_code">
<pre>#include <span style="color: #800000;">"</span><span style="color: #800000;">TestNativeMethod.h</span><span style="color: #800000;">"</span><span style="color: #000000;">
#include </span>&lt;stdio.h&gt;<span style="color: #000000;">

JNIEXPORT </span><span style="color: #0000ff;">void</span> JNICALL Java_TestNativeMethod_sayHello(JNIEnv *<span style="color: #000000;">, jclass) {
    printf(</span><span style="color: #800000;">"</span><span style="color: #800000;">Hello, this is a native method.\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);
}</span></pre>
</div>
<p>4、这个时候编译.cpp文件是100%报错的，你需要找到本地jdk文件夹内的两个.h文件：jni.h以及jni_md.h然后添加过去。。。。。。。然后设法将<strong>jni_md.h、sayHello_impl.cpp、TestNativeMethod.h、jni.h弄成一个<strong>sayHello_impl.</strong>ddl文件。</strong></p>
<p>PS. 本人没弄成功，好不容易弄出ddl，运行程序时却报了32bit的ddl和64bit平台不兼容，更新mingw64老半天进度条又没动静，so。。。。。。。。。</p>
<p><strong>5、最后再次运行TestNativeMethod就行了。所以native接口的实现是可以通过动态更改ddl而修改的。</strong></p>
<p>&nbsp;</p>