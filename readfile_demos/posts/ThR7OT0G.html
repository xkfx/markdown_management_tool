<p><a href="#a1">session的接口</a></p>
<p><a href="#a2">杀死会话</a></p>
<p><a href="#a3">cookie的性质</a></p>
<p><a href="#a4">cookie的接口</a></p>
<p><a href="#a5">&nbsp;再总结&mdash;&mdash;cookie、session、JSESSIONID的前世今生</a></p>
<p><a href="#a6">&nbsp;简单的定制cookie示例</a></p>
<p>&nbsp;</p>
<p><a name="a1"></a>1、session的接口，配合一些代码来理解。</p>
<p>&nbsp;<img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170608200312731-1358229614.png" alt="" /></p>
<p>&nbsp;</p>
<p><a name="a2"></a>2、杀死会话&mdash;&mdash;杀死的含义是使session无效化（在JVM中清除？？）。</p>
<ul>
<li>立刻杀死，已知方式有两种，</li>
</ul>
<p>&nbsp;<img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170608152339372-1353795435.png" alt="" width="534" height="39" /></p>
<p><img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170608152415559-1573417818.png" alt="" width="755" height="81" /></p>
<ul>
<li>在DD中设定&ldquo;默认期限&rdquo;</li>
</ul>
<p>&nbsp;<img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170608152136715-872432970.png" alt="" width="495" height="243" /></p>
<ul>
<li>在代码中对具体session设定&ldquo;期限&rdquo;（不过，如果你设置为-1的话，session将永远不会过期，因为这个时间永远到不了，，）</li>
<li><img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170608152240122-1891377698.png" alt="" width="535" height="237" /></li>
</ul>
<p><a name="a3"></a>3、cookie的特性</p>
<p><img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170608200726387-1541323757.png" alt="" width="323" height="407" /></p>
<p>&nbsp;</p>
<p><a name="a4"></a>4、cookie的接口</p>
<p><img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170608201106622-1524753002.png" alt="" /></p>
<p>从客户请求得到cookie&mdash;&mdash;稍微现代点的方法是这样的：</p>
<div class="cnblogs_code">
<pre><span style="color: #ff0000;"><strong>        Cookie[] cookies = request.getCookies();
        </strong></span><span style="color: #0000ff;">if</span>(<strong><span style="color: #ff0000;">cookies != null</span></strong><span style="color: #000000;">){
            </span><strong><span style="color: #ff0000;">for(Cookie cookie : cookies){
                </span></strong><span style="color: #0000ff;">if</span>(cookie.getName().equals("JSESSIONID"<span style="color: #000000;">)){
                    System.out.println(</span>"JSESSIONID="+<span style="color: #000000;">cookie.getValue());
                }
                cookie.setMaxAge(</span>0<span style="color: #000000;">);
                response.addCookie(cookie);
            <span style="color: #ff0000;"><strong>}</strong>
</span>        }</span></pre>
</div>
<p>&nbsp;</p>
<p><a name="a5"></a>5、&nbsp;再总结&mdash;&mdash;cookie、session的前世今生</p>
<ul>
<li>
<h3>cookie之前世今生。</h3>
</li>
</ul>
<p>cookie的产生：客户端向服务器发送request，服务器返回response并<strong><span style="color: #ff0000;">set-cookie</span></strong></p>
<p>就这样客户端中就存在一个对应cookie了，</p>
<p>cookie的后续：之后客户端每次向服务器发送request，<strong><span style="color: #ff0000;">都会携带这个cookie</span></strong></p>
<p><strong><span style="color: #ff0000;">本质上，cookie就是客户端和服务端交换一小段信息。</span></strong></p>
<ul>
<li>
<h3>session的前世今生</h3>
</li>
</ul>
<p>session的产生：通常是伴随着一个getSession语句 <span style="color: #888888;">//这里可能误,不论有没手动getSession，服务器是一定会set-cookie的，也就是说JSESSIONID一定会有，而有没有对应的session就不知道了。</span></p>
<p>session的后续：</p>
<ol>
<li>我们用session来管理会话、存储信息</li>
<li>我们必须通过JSESSIONID来查找访问对应的session</li>
<li>我们必须在适当的时候杀死session</li>
</ol>
<p><strong><span style="color: #ff0000;">本质上，session就是存在于服务端JVM中的一个对象。</span></strong></p>
<p>&nbsp;JSESSIONID的前世今生</p>
<p>可以把每一次submit都想象成完成了一次反射。</p>
<p><strong><span style="color: #ff00ff;">第一次submit</span></strong></p>
<p><img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170609091843809-490319321.png" alt="" /></p>
<p><span style="color: #ff00ff;">第二次到第n次...</span></p>
<p><img src="http://images2015.cnblogs.com/blog/1042431/201706/1042431-20170609092135403-829632959.png" alt="" width="373" height="230" /></p>
<p>&nbsp;</p>
<p><a name="a6"></a>6、&nbsp;简单的定制cookie示例&mdash;&mdash;输入姓名，输出 Hello+姓名</p>
<p>通常，我的习惯是先写一个hello程序跑通一下环境。</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">meta </span><span style="color: #ff0000;">charset</span><span style="color: #0000ff;">="US-ASCII"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>Home Page<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">form </span><span style="color: #ff0000;">action</span><span style="color: #0000ff;">="CookieTest.do"</span><span style="color: #ff0000;"> method</span><span style="color: #0000ff;">="post"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">

    Username: </span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="text"</span><span style="color: #ff0000;"> name</span><span style="color: #0000ff;">="username"</span><span style="color: #0000ff;">&gt;</span>
    
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">type</span><span style="color: #0000ff;">="submit"</span><span style="color: #ff0000;"> value</span><span style="color: #0000ff;">="submit"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">form</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="ISO-8859-1" </span><span style="color: #0000ff;">?&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">web-app </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://java.sun.com/xml/ns/j2ee"</span><span style="color: #ff0000;">
         xmlns:xsi</span><span style="color: #0000ff;">="http://www.w3.org/2001/XMLSchema-instance"</span><span style="color: #ff0000;">
         xsi:schemaLocation</span><span style="color: #0000ff;">="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span><span style="color: #ff0000;">
         version</span><span style="color: #0000ff;">="2.4"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>CookieTest<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-class</span><span style="color: #0000ff;">&gt;</span>com.example.web.CookieTest<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-class</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-mapping</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>CookieTest<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">url-pattern</span><span style="color: #0000ff;">&gt;</span>/CookieTest.do<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">url-pattern</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-mapping</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">web-app</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.example.web;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.ServletException;
</span><span style="color: #0000ff;">import</span> javax.servlet.http.*<span style="color: #000000;">;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.IOException;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> CookieTest <span style="color: #0000ff;">extends</span><span style="color: #000000;"> HttpServlet {
    @Override
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> doPost(HttpServletRequest req, HttpServletResponse resp) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> ServletException, IOException {
        resp.setContentType(</span>"text/html"<span style="color: #000000;">);
        resp.getWriter().println(</span>"hello"<span style="color: #000000;">);
    }
}</span></pre>
</div>
<p>&nbsp;成功跑出来之后开始写代码~</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.example.web;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.RequestDispatcher;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.ServletException;
</span><span style="color: #0000ff;">import</span> javax.servlet.http.*<span style="color: #000000;">;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.IOException;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> CookieTest <span style="color: #0000ff;">extends</span><span style="color: #000000;"> HttpServlet {
    @Override
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> doPost(HttpServletRequest req, HttpServletResponse resp) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> ServletException, IOException {
        resp.setContentType(</span>"text/html"<span style="color: #000000;">);

        String name </span>= req.getParameter("username"<span style="color: #000000;">);
        Cookie cookie </span>= <span style="color: #0000ff;">new</span> Cookie("username"<span style="color: #000000;">, name);
        cookie.setMaxAge(</span>30*60); <span style="color: #008000;">//</span><span style="color: #008000;"> 如果不设置的话，cookies的生存期限默认为&ldquo;关闭浏览器为止&rdquo;</span>
<span style="color: #000000;">        resp.addCookie(cookie);

        RequestDispatcher view </span>= req.getRequestDispatcher("result.jsp"<span style="color: #000000;">);
        view.forward(req, resp);
    }
}</span></pre>
</div>
<pre>result.jsp</pre>
<div class="cnblogs_code">
<pre>&lt;html&gt;
    &lt;body&gt;
        &lt;a href="checkcookie.do"&gt;click here&lt;/a&gt;
    &lt;/body&gt;
&lt;/html&gt;</pre>
</div>
<pre>checkcookie.do</pre>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;?</span><span style="color: #ff00ff;">xml version="1.0" encoding="ISO-8859-1" </span><span style="color: #0000ff;">?&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">web-app </span><span style="color: #ff0000;">xmlns</span><span style="color: #0000ff;">="http://java.sun.com/xml/ns/j2ee"</span><span style="color: #ff0000;">
         xmlns:xsi</span><span style="color: #0000ff;">="http://www.w3.org/2001/XMLSchema-instance"</span><span style="color: #ff0000;">
         xsi:schemaLocation</span><span style="color: #0000ff;">="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd"</span><span style="color: #ff0000;">
         version</span><span style="color: #0000ff;">="2.4"</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>CookieTest<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-class</span><span style="color: #0000ff;">&gt;</span>com.example.web.CookieTest<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-class</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-mapping</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>CookieTest<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">url-pattern</span><span style="color: #0000ff;">&gt;</span>/CookieTest.do<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">url-pattern</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-mapping</span><span style="color: #0000ff;">&gt;</span>
    
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>checkcookie<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-class</span><span style="color: #0000ff;">&gt;</span>com.example.web.CheckCookie<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-class</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet</span><span style="color: #0000ff;">&gt;</span>

    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-mapping</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>checkcookie<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-name</span><span style="color: #0000ff;">&gt;</span>
        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">url-pattern</span><span style="color: #0000ff;">&gt;</span>/checkcookie.do<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">url-pattern</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">servlet-mapping</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">web-app</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.example.web;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> javax.servlet.ServletException;
</span><span style="color: #0000ff;">import</span> javax.servlet.http.*<span style="color: #000000;">;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.IOException;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.PrintWriter;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span> CheckCookie <span style="color: #0000ff;">extends</span><span style="color: #000000;"> HttpServlet {
    @Override
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">void</span> doGet(HttpServletRequest req, HttpServletResponse resp) <span style="color: #0000ff;">throws</span><span style="color: #000000;"> ServletException, IOException {
        resp.setContentType(</span>"text/html"<span style="color: #000000;">);
        PrintWriter pw </span>=<span style="color: #000000;"> resp.getWriter();

        Cookie[] cookies </span>=<span style="color: #000000;"> req.getCookies();
        </span><span style="color: #0000ff;">if</span> (cookies != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (Cookie cookie : cookies) {
                </span><span style="color: #0000ff;">if</span> (cookie.getName().equals("username"<span style="color: #000000;">)) {
                    pw.println(</span>"Hello " +<span style="color: #000000;"> cookie.getValue());
                    </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                }
            }
        }
    }
}</span></pre>
</div>
<pre><br /><br />&lt;form action="CookieTest.do" method="post"&gt;</pre>
<pre> &lt;a href="checkcookie.do"&gt;click here&lt;/a&gt;</pre>